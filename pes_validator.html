<!DOCTYPE html>
<html>
<head>
    <title>PNP EMAIL SYSTEM (PES) PASSWORD RESET FILTER</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css" />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js"></script>
</head>
<body>
   <table id="pes_reset_tbl" class="display" style="width:100%">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Name</th>
                <th>PES_Email</th>
                <th>Password</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            <tr>
            </tr>
        </tbody>
    </table>
    <script>
        console.log('No Data..');
        const pesUrl = ['https://sheets.googleapis.com/v4/spreadsheets/1kdp0CNhxJZf7Bv2knQZouMftDVL5JYZVr1KMELOPYBU/values/January_2023?alt=json&key=AIzaSyBDSW_1Tq-o6g8doLQf7ZUaRyBUu5zzx8k','https://sheets.googleapis.com/v4/spreadsheets/1kdp0CNhxJZf7Bv2knQZouMftDVL5JYZVr1KMELOPYBU/values/February_2023?alt=json&key=AIzaSyBDSW_1Tq-o6g8doLQf7ZUaRyBUu5zzx8k','https://sheets.googleapis.com/v4/spreadsheets/1kdp0CNhxJZf7Bv2knQZouMftDVL5JYZVr1KMELOPYBU/values/March_2023?alt=json&key=AIzaSyBDSW_1Tq-o6g8doLQf7ZUaRyBUu5zzx8k','https://sheets.googleapis.com/v4/spreadsheets/1kdp0CNhxJZf7Bv2knQZouMftDVL5JYZVr1KMELOPYBU/values/April_2023?alt=json&key=AIzaSyBDSW_1Tq-o6g8doLQf7ZUaRyBUu5zzx8k','https://sheets.googleapis.com/v4/spreadsheets/1kdp0CNhxJZf7Bv2knQZouMftDVL5JYZVr1KMELOPYBU/values/May_2023?alt=json&key=AIzaSyBDSW_1Tq-o6g8doLQf7ZUaRyBUu5zzx8k'];
        const pesTable = $('#pes_reset_tbl').DataTable( {
               data: [],
               order: [[4, 'desc']],
               stateSave: true,
               columnDefs: [
                {
                    render: function (data, type, row) {
                       return '<strong>' + row[0] + data + '</strong>';
                    },
                    targets: 1,
                },],
                lengthMenu: [
                    [50, 100, -1],
                    [50, 100, 'All'],
                ],         
         } );
        async function pesExtract(){
            await Promise.all(
              pesUrl.map(async (url) => {
                const response = await fetch(url);
                var data = await response.json();
                var pesChunks = data.values;
                pesChunks.splice(0, 1);
                console.log('With Data..'+JSON.stringify(pesChunks));  
                pesTable.rows.add(pesChunks).draw(); //clear()
              })
            )
        }        
        pesExtract();
    </script>
</body>
</html>
